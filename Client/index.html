<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UNO on Solana</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>UNO on <span class="sol">Solana</span></h1>

  <!-- Controls -->
  <div id="controls">
    <input id="nicknameInput" type="text" placeholder="Enter nickname" />
    <button id="joinBtn">Join Game</button>
    <button id="connectWalletBtn">üîó Connect Wallet</button>
  </div>

  <!-- Status -->
  <div id="status">Waiting for players...</div>
  <div id="waiting"></div>

  <!-- Players -->
  <div id="players" class="players"></div>

  <!-- Game board -->
  <div class="board">
    <div id="top-card"></div>
    <!-- Pick Up button -->
    <button id="drawBtn" class="draw-btn" disabled>Pick Up</button>
  </div>

  <!-- Timer -->
  <div id="timer">‚è≥ 30s</div>
  <div id="timer-bar">
    <div id="timer-fill"></div>
  </div>

  <!-- Player hand -->
  <div id="hand" class="hand"></div>

  <!-- Wild color modal -->
  <div id="wildModal" class="modal">
    <div class="modal-content">
      <h2>Choose a Color</h2>
      <div class="color-buttons">
        <button class="color-btn" data-color="red" style="background:red"></button>
        <button class="color-btn" data-color="green" style="background:green"></button>
        <button class="color-btn" data-color="blue" style="background:blue"></button>
        <button class="color-btn" data-color="yellow" style="background:yellow"></button>
      </div>
    </div>
  </div>

  <!-- Leaderboard -->
  <div id="leaderboard" class="leaderboard">
    <h2>üåç Global Leaderboard</h2>
  </div>

  <!-- Next game overlay -->
  <div id="nextGameOverlay" class="modal">
    <div class="modal-content">
      <h2 id="nextGameMessage">Next game starting...</h2>
      <button id="leaveBtn">Leave Game</button>
    </div>
  </div>

  <!-- Sounds -->
  <audio id="bg-music" src="background.mp3" loop></audio>
  <audio id="card-sound" src="card.mp3"></audio>

  <!-- Scripts -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    // ‚úÖ Wallet connect logic (Phantom)
    const connectWalletBtn = document.getElementById("connectWalletBtn");
    connectWalletBtn.addEventListener("click", async () => {
      if (window.solana && window.solana.isPhantom) {
        try {
          const resp = await window.solana.connect();
          const wallet = resp.publicKey.toString();
          localStorage.setItem("unoWallet", wallet);
          alert(`‚úÖ Wallet connected: ${wallet.slice(0,4)}...${wallet.slice(-4)}`);
        } catch (err) {
          console.error("Wallet connection failed", err);
        }
      } else {
        alert("‚ö†Ô∏è Phantom Wallet not found. Please install it.");
        window.open("https://phantom.app/", "_blank");
      }
    });

    // ‚úÖ Background music auto-play after first interaction
    const bgMusic = document.getElementById("bg-music");
    document.addEventListener("click", () => {
      if (bgMusic.paused) {
        bgMusic.play().catch(() => {});
      }
    }, { once: true });
  </script>
  <script src="app.js"></script>
</body>
</html>
